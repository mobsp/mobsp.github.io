<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <style>
        /* é€™è£¡åªåˆ—å‡ºéœ€è¦å¾®èª¿çš„æ¨£å¼ï¼Œå…¶é¤˜ä¿æŒä½ åŸæœ¬çš„ App ä½ˆå±€ */
        .v-tag { 
            transition: all 0.3s; 
            text-transform: uppercase;
        }
        /* å®šç¾©ä¸åŒåˆ†é¡çš„é¡è‰² */
        .tag-important { background: #ff7675 !important; color: white; }
        .tag-update { background: #55efc4 !important; color: #000; }
        .tag-default { background: var(--primary-color); color: #000; }
    </style>
</head>
<body>

<div class="page-wrapper">
    <header class="app-header">
        <div class="marquee-row">
            <span class="v-tag" id="version-tag">LOADING</span>
            <div class="mq-box">
                <div class="mq-text" id="remote-notice">åŒæ­¥ä¸­...</div>
            </div>
        </div>
        <h1 style="font-size: 1.3rem; margin: 0; text-align: center; letter-spacing: 3px;">â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” ğ”¢</h1>
    </header>

    </div>

<script>
const NOTICE_URL = 'https://raw.githubusercontent.com/mobsp/mobsp.github.io/main/data/notice.md';

async function autoUpdateNotice() {
    const noticeEl = document.getElementById('remote-notice');
    const versionEl = document.getElementById('version-tag');

    try {
        const response = await fetch(NOTICE_URL, { cache: "no-cache" });
        const rawText = await response.text();
        const lines = rawText.split('\n').filter(l => l.trim() !== '');

        // --- 1. ç‰ˆæœ¬è™Ÿé‚è¼¯ ---
        const baseVersion = lines[0].startsWith('#') ? lines[0].replace('#', '').trim() : "v1.0";
        const contentBody = lines.slice(1).join('\n'); // çœŸæ­£çš„å…¬å‘Šå…§å®¹
        
        let finalVersion = baseVersion;
        const savedContent = localStorage.getItem('last_notice_content');
        const savedVersion = localStorage.getItem('current_display_version');

        if (savedContent && savedContent !== contentBody) {
            // å¦‚æœå…§å®¹è®Šäº†ï¼Œä½†åŸºç¤ç‰ˆæœ¬è™Ÿæ²’è®Šï¼Œå°±è‡ªå‹• +0.1
            if (savedVersion && savedVersion.startsWith(baseVersion.split('.')[0])) {
                let currentNum = parseFloat(savedVersion.replace('v', ''));
                finalVersion = 'v' + (currentNum + 0.1).toFixed(1);
            } else {
                finalVersion = baseVersion;
            }
        } else if (savedVersion) {
            finalVersion = savedVersion;
        }

        localStorage.setItem('last_notice_content', contentBody);
        localStorage.setItem('current_display_version', finalVersion);

        // --- 2. éš¨æ©ŸæŠ½å–èˆ‡åˆ†é¡è§£æ ---
        const quotes = lines.slice(1);
        const randomLine = quotes[Math.floor(Math.random() * quotes.length)].trim();
        
        // è§£æ [åˆ†é¡] æ–‡å­—
        const categoryMatch = randomLine.match(/\[(.*?)\]/);
        let category = "NEWS";
        let cleanText = randomLine;

        if (categoryMatch) {
            category = categoryMatch[1];
            cleanText = randomLine.replace(categoryMatch[0], '').trim();
            
            // æ ¹æ“šåˆ†é¡æ›é¡è‰²
            versionEl.className = 'v-tag'; // é‡ç½®
            if (category.includes('é‡è¦')) versionEl.classList.add('tag-important');
            else if (category.includes('æ›´æ–°')) versionEl.classList.add('tag-update');
            else versionEl.classList.add('tag-default');
        }

        // 3. æ¸²æŸ“
        versionEl.innerText = `${finalVersion} | ${category}`;
        noticeEl.innerText = cleanText;

    } catch (e) {
        versionEl.innerText = "v1.0";
        noticeEl.innerText = "æ­¡è¿ä¾†åˆ° â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰ è³‡æºç©ºé–“";
    }
}

window.onload = autoUpdateNotice;
</script>
</body>
</html>
