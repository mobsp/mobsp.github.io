<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰</title>

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0b0b0c">

<style>
:root {
  --bg-color: #0b0b0c;          
  --card-bg: rgba(25, 27, 31, 0.95); 
  --text-main: #f1f2f6;         
  --primary-color: #00cec9;     
  --border-color: rgba(255, 255, 255, 0.1); 
  --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
}

/* åŸºç¤ä½ˆå±€ï¼šç¢ºä¿ä¸æœƒ white-screen */
html, body {
  width: 100%; height: 100dvh; overflow: hidden;
  position: fixed; margin: 0; padding: 0;
  background-color: var(--bg-color); color: var(--text-main);
  font-family: 'PingFang TC', system-ui, sans-serif;
}

.page-wrapper { display: flex; flex-direction: column; height: 100dvh; max-width: 500px; margin: 0 auto; }

/* å›ºå®šé é¦– */
.app-header {
  flex-shrink: 0; padding: calc(20px + env(safe-area-inset-top)) 20px 15px;
  background: rgba(11, 11, 12, 0.9); backdrop-filter: blur(15px);
  border-bottom: 1px solid var(--border-color); z-index: 100;
}

.marquee-row {
  display: flex; align-items: center; background: rgba(0,0,0,0.4);
  padding: 5px 10px; border-radius: 8px; margin-bottom: 10px; overflow: hidden;
}

/* å°æ¨™ç±¤æ¨£å¼ */
.v-tag { background: var(--primary-color); color: #000; font-size: 10px; font-weight: 900; padding: 2px 5px; border-radius: 4px; margin-right: 8px; white-space: nowrap; }
.tag-important { background: #ff7675 !important; color: white; }
.tag-update { background: #55efc4 !important; color: #000; }

.mq-box { flex: 1; overflow: hidden; white-space: nowrap; }
.mq-text { display: inline-block; animation: mq 15s linear infinite; font-size: 11px; opacity: 0.8; }
@keyframes mq { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

/* ä¸­é–“æ»‘å¡Š */
.app-main {
  flex: 1; display: flex; align-items: center; overflow-x: auto;
  scroll-snap-type: x mandatory; padding: 0 30px; gap: 20px; scrollbar-width: none;
}
.app-main::-webkit-scrollbar { display: none; }

.action-btn {
  flex: 0 0 85%; height: 80%; scroll-snap-align: center; text-decoration: none;
  border-radius: 35px; position: relative; overflow: hidden; border: 1px solid var(--border-color);
  background: #1e272e url('https://mobsp.github.io/assets/brand/cherry-blossom.jpg') center/cover;
}

.btn-overlay { position: absolute; bottom: 0; width: 100%; padding: 40px 25px 30px; background: linear-gradient(transparent, rgba(0,0,0,0.9)); }
.btn-title { color: #fff; font-size: 1.8rem; font-weight: 800; }

/* å›ºå®šé å°¾ */
.app-footer {
  flex-shrink: 0; padding: 15px 20px calc(15px + env(safe-area-inset-bottom));
  background: rgba(11, 11, 12, 0.9); border-top: 1px solid var(--border-color); text-align: center;
}
.copyright { font-size: 10px; opacity: 0.3; }
</style>
</head>

<body>
<div class="page-wrapper">
  <header class="app-header">
    <div class="marquee-row">
      <span class="v-tag" id="v-tag">LOADING</span>
      <div class="mq-box">
        <div class="mq-text" id="mq-text">æ­£åœ¨åŒæ­¥ â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰ æ•¸æ“šä¸­...</div>
      </div>
    </div>
    <h1 style="font-size: 1.3rem; margin: 0; text-align: center; letter-spacing: 3px;">â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰</h1>
  </header>

  <main class="app-main">
    <a href="./blog/" class="action-btn"><div class="btn-overlay"><div class="btn-title">éƒ¨è½æ ¼</div></div></a>
    <a href="./tol/" class="action-btn"><div class="btn-overlay"><div class="btn-title">å·¥å…·åº«</div></div></a>
    <a href="./p/#Music" class="action-btn"><div class="btn-overlay"><div class="btn-title">éŸ³æ¨‚é »é“</div></div></a>
    <a href="./p/#Shorts" class="action-btn"><div class="btn-overlay"><div class="btn-title">çŸ­å½±éŸ³</div></div></a>
  </main>

  <footer class="app-footer">
    <div class="copyright">&copy; 2024â€“2026 è«æ¯”ç©ºé–“ â’¸ All Rights Reserved.</div>
  </footer>
</div>

<script>
// å¼·åˆ¶ä½¿ç”¨ RAW ç¶²å€ï¼Œé¿å…æŠ“åˆ° GitHub çš„ç¶²é çµæ§‹
const MD_URL = 'https://raw.githubusercontent.com/mobsp/mobsp.github.io/main/data/notice.md';

async function loadNotice() {
    const vTag = document.getElementById('v-tag');
    const mqText = document.getElementById('mq-text');

    try {
        // è¨­å®šè¶…æ™‚æ§åˆ¶ï¼Œå¦‚æœ 5 ç§’æ²’åæ‡‰å°±æ”¾æ£„ï¼Œé¿å…ç¶²é ä¸€ç›´å¡ä½
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 5000);

        const response = await fetch(MD_URL, { 
            cache: 'no-cache',
            signal: controller.signal 
        });
        
        if (!response.ok) throw new Error('Fetch Error');
        const raw = await response.text();
        const lines = raw.split('\n').map(l => l.trim()).filter(l => l.length > 0);

        // --- ç‰ˆæœ¬è™Ÿé‚è¼¯ ---
        let baseVer = lines[0].startsWith('#') ? lines[0].replace('#', '') : "v1.0";
        let contentBody = lines.slice(1).join('|'); 
        
        let lastContent = localStorage.getItem('mob_last_content');
        let currentVer = localStorage.getItem('mob_curr_ver') || baseVer;

        if (lastContent && lastContent !== contentBody) {
            let verNum = parseFloat(currentVer.replace('v', ''));
            currentVer = 'v' + (verNum + 0.1).toFixed(1);
        }
        
        localStorage.setItem('mob_last_content', contentBody);
        localStorage.setItem('mob_curr_ver', currentVer);

        // --- éš¨æ©ŸæŠ½å–ä¸€å¥ ---
        const quotes = lines.slice(1);
        const randomItem = quotes[Math.floor(Math.random() * quotes.length)];
        
        // è§£æåˆ†é¡ [XXX]
        let category = "NEWS";
        let displayMsg = randomItem;
        const catMatch = randomItem.match(/\[(.*?)\]/);
        
        if (catMatch) {
            category = catMatch[1];
            displayMsg = randomItem.replace(catMatch[0], '');
            // è®Šæ›é¡è‰²
            vTag.classList.remove('tag-important', 'tag-update');
            if (category.includes('é‡è¦')) vTag.classList.add('tag-important');
            if (category.includes('æ›´æ–°')) vTag.classList.add('tag-update');
        }

        vTag.innerText = `${currentVer} | ${category}`;
        mqText.innerText = displayMsg;

    } catch (err) {
        console.log("Using default fallback", err);
        vTag.innerText = "v1.0 | INFO";
        mqText.innerText = "æ­¡è¿ä¾†åˆ° â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰ï¼è«‹å·¦å³æ»‘å‹•æ¢ç´¢è³‡æºã€‚";
    }
}

// ç¢ºä¿ DOM è¼‰å…¥å¾Œæ‰åŸ·è¡Œï¼Œé¿å…æŠ“ä¸åˆ° Element
document.addEventListener('DOMContentLoaded', loadNotice);
</script>
</body>
</html>
