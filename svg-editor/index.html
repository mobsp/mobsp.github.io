<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SVG Editor | â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰</title>
    <style>
        :root { 
            --bg: #0d1117; --panel: #161b22; --border: #30363d; 
            --accent: #58a6ff; --header-h: 60px; --footer-h: 80px;
        }
        
        /* æ ¸å¿ƒï¼šé–å®šè¦–çª—é«˜åº¦ï¼Œç¦æ­¢å¤–å±¤æ»¾å‹• */
        html, body { 
            margin: 0; padding: 0; height: 100%; overflow: hidden; 
            background: var(--bg); color: white; font-family: -apple-system, sans-serif;
        }

        /* é é¦–ï¼šå›ºå®šé«˜åº¦ */
        header {
            height: var(--header-h);
            background: var(--panel);
            border-bottom: 1px solid var(--border);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; box-sizing: border-box;
        }

        /* å®¹å™¨ï¼šæ‰£é™¤é ­å°¾å¾Œæ’æ»¿ */
        .app-container {
            height: calc(100% - var(--header-h) - var(--footer-h));
            display: flex; flex-direction: column;
        }
        @media (min-width: 768px) { .app-container { flex-direction: row; } }

        /* å·¦å´/ä¸Šæ–¹é è¦½å€ï¼šå¯ç¨ç«‹æ»¾å‹• */
        .preview-section {
            flex: 1; overflow-y: auto; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            background: radial-gradient(circle, #1c2128 0%, #0d1117 100%);
        }
        .canvas {
            width: 100%; max-width: 300px; aspect-ratio: 1;
            background-image: linear-gradient(45deg, #161b22 25%, transparent 25%), 
                              linear-gradient(-45deg, #161b22 25%, transparent 25%),
                              linear-gradient(45deg, transparent 75%, #161b22 75%),
                              linear-gradient(-45deg, transparent 75%, #161b22 75%);
            background-size: 20px 20px; background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            border: 1px solid var(--border); border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
        }
        #svg-target { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        /* å³å´/ä¸‹æ–¹æ§åˆ¶å€ï¼šå¯ç¨ç«‹æ»¾å‹• */
        .control-section {
            flex: 1; background: var(--panel); border-top: 1px solid var(--border);
            padding: 20px; overflow-y: auto; -webkit-overflow-scrolling: touch;
        }
        @media (min-width: 768px) { 
            .control-section { width: 350px; flex: none; border-top: none; border-left: 1px solid var(--border); } 
        }

        /* é å°¾ï¼šå›ºå®šç”¢å‡ºæŒ‰éˆ•å€ */
        footer {
            height: var(--footer-h);
            background: var(--panel);
            border-top: 1px solid var(--border);
            padding: 10px 20px; display: flex; align-items: center; gap: 10px;
            box-sizing: border-box;
        }

        /* UI çµ„ä»¶æ¨£å¼ */
        .ctrl-group { margin-bottom: 25px; }
        .ctrl-group h4 { margin: 0 0 10px; font-size: 0.9rem; color: var(--accent); }
        label { display: block; font-size: 0.75rem; color: #8b949e; margin-bottom: 5px; }
        select, input { 
            width: 100%; padding: 10px; background: #0d1117; color: white; 
            border: 1px solid var(--border); border-radius: 8px; appearance: none;
        }
        .output-box {
            flex: 1; background: #000; border-radius: 6px; padding: 10px;
            font-family: monospace; font-size: 0.7rem; color: #3fb950;
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
        }
        .btn-action {
            background: var(--accent); color: white; border: none;
            padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer;
        }
    </style>
</head>
<body>

    <header>
        <div onclick="history.back()" style="cursor:pointer">âœ•</div>
        <div id="icon-title">Editor</div>
        <div style="color:var(--accent)">å„²å­˜</div>
    </header>

    <div class="app-container">
        <section class="preview-section">
            <div class="canvas">
                <img id="svg-target" src="" alt="Preview">
            </div>
            <p style="font-size: 0.7rem; color: #8b949e; margin-top: 15px;">é è¦½æ•ˆæœ</p>
        </section>

        <section class="control-section" id="config-panel">
            </section>
    </div>

    <footer>
        <div class="output-box" id="code-preview">é»æ“Šç”¢ç”Ÿä»£ç¢¼...</div>
        <button class="btn-action" onclick="applySettings()">åŸ·è¡Œ</button>
    </footer>

    <script>
        const params = new URLSearchParams(window.location.search);
        const iconName = params.get('icon');
        const svgUrl = `https://mobsp.github.io/assets/icon/svg/${iconName}`;
        
        document.getElementById('icon-title').textContent = iconName;
        document.getElementById('svg-target').src = svgUrl;

        async function init() {
            try {
                const res = await fetch('../data/editor_config.json');
                const config = await res.json();
                const panel = document.getElementById('config-panel');
                
                config.ui_groups.forEach(group => {
                    const div = document.createElement('div');
                    div.className = 'ctrl-group';
                    div.innerHTML = `<h4>${group.group_name}</h4>`;
                    group.controls.forEach(ctrl => {
                        const label = document.createElement('label');
                        label.textContent = ctrl.label;
                        const input = ctrl.type === 'select' ? document.createElement('select') : document.createElement('input');
                        if(ctrl.type === 'select') {
                            ctrl.options.forEach(opt => input.add(new Option(opt, opt)));
                        } else {
                            input.type = ctrl.type;
                            if(ctrl.default) input.value = ctrl.default;
                        }
                        input.id = ctrl.id;
                        div.appendChild(label);
                        div.appendChild(input);
                    });
                    panel.appendChild(div);
                });
            } catch (e) { console.error(e); }
        }

        function applySettings() {
            const size = document.getElementById('size').value;
            const color = document.getElementById('color').value;
            const rotate = document.getElementById('rotate').value;
            
            const img = document.getElementById('svg-target');
            img.style.width = size;
            img.style.filter = `drop-shadow(0 0 0 ${color})`;
            img.style.transform = `rotate(${rotate})`;
            
            const code = `<img src="${svgUrl}" style="width:${size}; filter:drop-shadow(0 0 0 ${color}); transform:rotate(${rotate})">`;
            document.getElementById('code-preview').textContent = code;
            
            // æ‰‹æ©Ÿéœ‡å‹•å›é¥‹ (å¦‚æœæœ‰æ”¯æ´)
            if(navigator.vibrate) navigator.vibrate(50);
            alert("ä»£ç¢¼å·²ç”¢ç”Ÿï¼");
        }

        init();
    </script>
</body>
</html>
