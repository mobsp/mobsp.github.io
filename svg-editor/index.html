<div class="bottom-actions">
    <div class="btn-row">
        <button class="btn btn-run" onclick="mobiRender()"><i class="fa-solid fa-bolt"></i> 執行產出</button>
        <button class="btn btn-dark" onclick="mobiCopy()">複製</button>
        <button class="btn btn-dark" onclick="mobiClear()">清除</button>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px;">
        <button class="btn btn-dark" onclick="saveSettings()">
            <i class="fa-solid fa-floppy-disk"></i> 儲存目前參數
        </button>
        <button class="btn btn-dark" onclick="loadSettings()">
            <i class="fa-solid fa-clock-rotate-left"></i> 載入上次存檔
        </button>
    </div>

    <div id="mobi-out" class="edit-box" contenteditable="true"></div>
</div>

<script>
// --- 儲存功能邏輯 (Save/Load) ---

function saveSettings() {
    const settings = {
        bg_fill: document.getElementById('bg_fill').value,
        icon_fill: document.getElementById('icon_fill').value,
        icon_stroke: document.getElementById('icon_stroke').value,
        radius_mode: document.getElementById('radius_mode').value,
        size: document.getElementById('size').value
    };
    localStorage.setItem('mobi_svg_config', JSON.stringify(settings));
    alert('✅ 參數已儲存！下次開啟將自動套用此風格。');
}

function loadSettings() {
    const saved = localStorage.getItem('mobi_svg_config');
    if (saved) {
        const settings = JSON.parse(saved);
        // 將儲存的值填回輸入框
        if(document.getElementById('bg_fill')) document.getElementById('bg_fill').value = settings.bg_fill;
        if(document.getElementById('icon_fill')) document.getElementById('icon_fill').value = settings.icon_fill;
        if(document.getElementById('icon_stroke')) document.getElementById('icon_stroke').value = settings.icon_stroke;
        if(document.getElementById('radius_mode')) document.getElementById('radius_mode').value = settings.radius_mode;
        if(document.getElementById('size')) document.getElementById('size').value = settings.size;
        
        mobiUpdate(); // 立即更新預覽圖
        alert('🔄 已載入上次儲存的風格設定！');
    } else {
        alert('查無儲存紀錄。');
    }
}

// 頁面載入時自動檢查有沒有存檔
window.addEventListener('load', () => {
    setTimeout(loadSettings, 500); // 延遲一下確保 JSON 已載入生成 UI
});
</script>
