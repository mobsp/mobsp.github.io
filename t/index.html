<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>â²˜â³ è«æ¯”ç©ºé–“ - çµ‚æ¥µæ¸¬è©¦ç‰ˆ</title>
    <style>
        body { background: #0a0a0a; color: #00d4ff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .marquee-container { width: 90%; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; overflow: hidden; }
        .content { display: inline-block; white-space: nowrap; animation: move 20s linear infinite; font-size: 1.5rem; }
        @keyframes move { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
    </style>
</head>
<body>
    <h2>ğŸ“¡ æ¸¬è©¦ä¸­...</h2>
    <div class="marquee-container">
        <div id="marquee" class="content">é€£ç·šä¸­ï¼Œè«‹ç¨å€™...</div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const URL = 'https://svwrvxomytbfaqpfnifg.supabase.co';
        // é€™æ˜¯ä½ å‰›å‰›çµ¦æˆ‘çš„ service_role key
        const KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN2d3J2eG9teXRiZmFxcGZuaWZnIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MTI1Nzc2MSwiZXhwIjoyMDg2ODMzNzYxfQ.15r8FoXm1YxdiioGWrkwdIwF6SQxCHtLJTF0BEruwZ8';
        const _supabase = supabase.createClient(URL, KEY);

        async function run() {
            const el = document.getElementById('marquee');
            try {
                // 1. å˜—è©¦æŠ“å–è‹±æ–‡åè¡¨æ ¼
                let { data, error } = await _supabase.from('notices').select('*');
                
                // 2. å¦‚æœå ±éŒ¯ï¼Œè‡ªå‹•å˜—è©¦æŠ“å–ä¸­æ–‡åè¡¨æ ¼
                if (error) {
                    const retry = await _supabase.from('é€šçŸ¥').select('*');
                    data = retry.data;
                    error = retry.error;
                }

                if (error) throw error;

                if (data && data.length > 0) {
                    const row = data[0];
                    // è‡ªå‹•åˆ¤æ–·æ¬„ä½ï¼šä¸ç®¡æ˜¯ä¸­æ–‡æ¨™é¡Œé‚„æ˜¯è‹±æ–‡æ¨™é¡Œéƒ½é€š
                    const t = row.é¡åˆ¥ || row.type || "å…¬å‘Š";
                    const m = row.å…§å®¹ || row.message || "ç„¡å…§å®¹";
                    
                    el.innerHTML = data.map(item => `[${item.é¡åˆ¥ || item.type || 'å…¬å‘Š'}] ${item.å…§å®¹ || item.message || '...'}`).join(' ï½œ ');
                } else {
                    el.innerHTML = "âœ… é€£ç·šæˆåŠŸï¼Œä½†è¡¨æ ¼è£¡æ˜¯ç©ºçš„ï¼è«‹å» Supabase æ–°å¢å…§å®¹ä¸¦å­˜æª”ã€‚";
                }
            } catch (err) {
                el.innerHTML = "âŒ é‚„æ˜¯ä¸è¡Œï¼š " + err.message;
            }
        }
        run();
    </script>
</body>
</html>
