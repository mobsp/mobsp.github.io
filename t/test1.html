<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰ | Shorts</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --accent-color: #00cec9; --icon-shadow: 0 2px 8px rgba(0,0,0,0.5); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; font-family: -apple-system, sans-serif; height: 100%; background: #000; color: #fff; }

        /* å•Ÿå‹•ç•«é¢ */
        #splash-screen { position: fixed; inset: 0; z-index: 10000; background: #000 url('https://mobsp.github.io/assets/brand/ms-shorts.JPEG') center/cover no-repeat; transition: opacity 0.5s; }
        #splash-screen.hide { opacity: 0; pointer-events: none; }

        /* ä¸»å°èˆªèˆ‡æ¨™ç±¤ (Line Voom é¢¨æ ¼) */
        .nav-bar { position: sticky; top: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; background: inherit; border-bottom: 1px solid rgba(128,128,128,0.2); }
        .profile-header { display: flex; flex-direction: column; align-items: center; padding: 25px 0; background: inherit; }
        .profile-avatar { width: 80px; height: 80px; border-radius: 50%; overflow: hidden; border: 1px solid rgba(128,128,128,0.3); }
        .profile-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .tabs { display: flex; border-bottom: 1px solid rgba(128,128,128,0.2); position: sticky; top: 45px; z-index: 90; background: inherit; }
        .tab-item { flex: 1; text-align: center; padding: 12px; font-weight: bold; color: #999; cursor: pointer; position: relative; }
        .tab-item.active { color: inherit; }
        .tab-item.active::after { content: ''; position: absolute; bottom: 0; left: 35%; width: 30%; height: 2px; background: currentColor; }

        /* è¦–åœ–é¡¯ç¤º */
        #feed-view { display: block; background: #000; }
        #grid-view { display: none; grid-template-columns: repeat(3, 1fr); gap: 1px; background: #fff; }
        .video-preview, .grid-item { cursor: pointer; background: #111; position: relative; }
        .video-preview video, .grid-item video { width: 100%; height: 100%; object-fit: cover; aspect-ratio: 9/16; }
        .grid-item { aspect-ratio: 3/4; }

        /* å…¨è¢å¹•ç£å¸æ’­æ”¾å™¨ */
        #player-overlay { position: fixed; inset: 0; background: #000; z-index: 2000; display: none; }
        .shorts-wrapper { height: 100dvh; width: 100vw; overflow-y: scroll; scroll-snap-type: y mandatory; scrollbar-width: none; }
        .shorts-wrapper::-webkit-scrollbar { display: none; }
        .short-card { height: 100dvh; width: 100vw; scroll-snap-align: start; position: relative; }
        .short-card video { width: 100%; height: 100%; object-fit: cover; }

        /* å³å´åŠŸèƒ½æ¬„ */
        .side-bar { position: absolute; right: 12px; bottom: 100px; display: flex; flex-direction: column; gap: 15px; align-items: center; z-index: 10; }
        .action-item { color: #fff; text-shadow: var(--icon-shadow); cursor: pointer; text-align: center; }
        .action-item i { font-size: 26px; }
        .action-item span { font-size: 11px; display: block; margin-top: 4px; }

        /* è¼‰å…¥é€²åº¦çµ„åˆä»¶ */
        .loader-box { display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .music-disc { 
            width: 48px; height: 48px; border-radius: 50%; border: 2px solid rgba(255,255,255,0.2); 
            overflow: hidden; animation: rotate 4s linear infinite; background: #222;
        }
        .music-disc img { width: 100%; height: 100%; object-fit: cover; }
        .load-pct { 
            font-size: 10px; color: var(--accent-color); font-weight: bold; 
            text-shadow: 0 1px 3px #000; transition: opacity 0.5s; 
        }
        .load-pct.finished { opacity: 0; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .bottom-info { position: absolute; bottom: 40px; left: 15px; right: 80px; color: #fff; text-shadow: var(--icon-shadow); pointer-events: none; }
        .close-btn { position: absolute; top: 40px; left: 20px; z-index: 2100; color: #fff; font-size: 24px; cursor: pointer; }

        body.light-mode { background: #fff; color: #000; }
    </style>
</head>
<body class="dark-mode">

    <div id="splash-screen"></div>

    <div id="main-page">
        <div class="nav-bar">
            <i class="fa-solid fa-chevron-left" onclick="location.href='https://mobsp.github.io/blog/'"></i>
            <span style="font-weight: bold;">è«æ¯”ç©ºé–“</span>
            <i class="fa-solid fa-ellipsis-vertical"></i>
        </div>
        <div class="profile-header">
            <div class="profile-avatar"><img src="https://mobsp.github.io/assets/brand/ms-logo.JPEG"></div>
            <button style="border:1px solid #ddd; background:transparent; color:inherit; padding:6px 30px; border-radius:6px; margin-top:10px; font-weight:bold;">è¿½è¹¤ä¸­</button>
        </div>
        <div class="tabs">
            <div class="tab-item active" onclick="showView('all')">å…¨éƒ¨</div>
            <div class="tab-item" onclick="showView('video')">å½±ç‰‡</div>
        </div>
        <div id="feed-view"></div>
        <div id="grid-view"></div>
    </div>

    <div id="player-overlay">
        <i class="fa-solid fa-xmark close-btn" onclick="closePlayer()"></i>
        <div class="shorts-wrapper" id="shortsWrapper"></div>
    </div>

    <script>
        const videoSources = [
            "https://files.catbox.moe/xh7uyj.mp4", "https://files.catbox.moe/u94tk7.mp4", "https://files.catbox.moe/aizh9p.mp4",
            "https://files.catbox.moe/t9ojp9.mp4", "https://files.catbox.moe/xcqf9s.mp4", "https://files.catbox.moe/zzuqo4.mp4",
            "https://files.catbox.moe/t0mil6.mp4", "https://files.catbox.moe/rw7p6b.MP4", "https://files.catbox.moe/nvq49m.mp4",
            "https://files.catbox.moe/9fvg1s.mp4", "https://files.catbox.moe/9461nt.mp4", "https://files.catbox.moe/e93uth.mp4",
            "https://files.catbox.moe/79y11a.mp4", "https://files.catbox.moe/0d6dx3.mp4", "https://files.catbox.moe/00mt42.mp4",
            "https://files.catbox.moe/fret8a.mp4", "https://files.catbox.moe/kmgu5w.mp4", "https://files.catbox.moe/dwtlj4.mp4"
        ];

        let isMuted = true;

        function init() {
            const feed = document.getElementById('feed-view');
            const grid = document.getElementById('grid-view');
            const wrapper = document.getElementById('shortsWrapper');

            videoSources.forEach((src, idx) => {
                // å…¨éƒ¨ (Feed)
                const fItem = document.createElement('div');
                fItem.className = 'feed-item';
                fItem.innerHTML = `<div style="padding:15px; font-weight:bold; font-size:14px"><img src="https://mobsp.github.io/assets/brand/ms-logo.JPEG" style="width:30px; height:30px; border-radius:50%; vertical-align:middle; margin-right:10px; object-fit:cover">è«æ¯”ç©ºé–“</div><div class="video-preview" onclick="openPlayer(${idx})"><video src="${src}#t=0.1" muted playsinline></video></div>`;
                feed.appendChild(fItem);

                // å½±ç‰‡ (Grid)
                const gItem = document.createElement('div');
                gItem.className = 'grid-item';
                gItem.onclick = () => openPlayer(idx);
                gItem.innerHTML = `<video src="${src}#t=0.1" muted playsinline></video><i class="fa-solid fa-play" style="position:absolute; top:8px; right:8px; font-size:10px"></i>`;
                grid.appendChild(gItem);

                // å…¨è¢å¹•å¡ç‰‡ (å¸¶é€²åº¦é¡¯ç¤º)
                const card = document.createElement('div');
                card.className = 'short-card';
                card.innerHTML = `
                    <video loop playsinline data-src="${src}" muted onclick="this.paused?this.play():this.pause()"></video>
                    <div class="side-bar">
                        <div class="action-item" onclick="toggleMute(event)"><i class="fa-solid fa-volume-xmark mute-icon"></i><span>éŸ³é‡</span></div>
                        <div class="action-item" onclick="shareVideo(event)"><i class="fa-solid fa-share"></i><span>åˆ†äº«</span></div>
                        <div class="loader-box">
                            <div class="music-disc"><img src="https://mobsp.github.io/assets/brand/ms-logo.JPEG"></div>
                            <div class="load-pct">0%</div>
                        </div>
                    </div>
                    <div class="bottom-info"><div style="font-weight:bold">@Mobispace_Music</div><div style="font-size:13px; opacity:0.8">â²˜ğ”¬â²ƒÂ¡â³ğ”­â²ğ” â²‰â„¢ï¸ è«æ¯”éŸ³æ¨‚é »é“ #MobiShorts</div></div>
                `;
                wrapper.appendChild(card);
            });
            setupProgressTracking();
            setupObserver();
        }

        // æ ¸å¿ƒï¼šè¿½è¹¤æª”æ¡ˆè¼‰å…¥é€²åº¦
        function setupProgressTracking() {
            document.querySelectorAll('.short-card').forEach(card => {
                const video = card.querySelector('video');
                const pctText = card.querySelector('.load-pct');

                video.addEventListener('progress', () => {
                    if (video.duration > 0 && video.buffered.length > 0) {
                        const bufferedEnd = video.buffered.end(video.buffered.length - 1);
                        const percent = Math.round((bufferedEnd / video.duration) * 100);
                        pctText.innerText = percent + '%';
                        
                        // è¼‰å…¥å®Œæˆéš±è—
                        if (percent >= 100) pctText.classList.add('finished');
                    }
                });
                // ç¢ºä¿æ’­æ”¾æ™‚ä¹Ÿæœƒæª¢æŸ¥ä¸€æ¬¡
                video.addEventListener('canplaythrough', () => {
                    pctText.innerText = '100%';
                    pctText.classList.add('finished');
                });
            });
        }

        function toggleMute(e) {
            e.stopPropagation();
            isMuted = !isMuted;
            document.querySelectorAll('.short-card video').forEach(v => v.muted = isMuted);
            document.querySelectorAll('.mute-icon').forEach(i => i.className = isMuted ? 'fa-solid fa-volume-xmark mute-icon' : 'fa-solid fa-volume-high mute-icon');
        }

        async function shareVideo(e) {
            e.stopPropagation();
            if (navigator.share) { try { await navigator.share({ title: 'è«æ¯”ç©ºé–“ Shorts', url: window.location.href }); } catch (err) {} }
            else { alert('é€£çµå·²è¤‡è£½'); }
        }

        function openPlayer(idx) {
            document.getElementById('player-overlay').style.display = 'block';
            const cards = document.querySelectorAll('.short-card');
            cards[idx].scrollIntoView();
            const v = cards[idx].querySelector('video');
            if(!v.src) v.src = v.dataset.src;
            v.play();
        }

        function closePlayer() {
            document.getElementById('player-overlay').style.display = 'none';
            document.querySelectorAll('.short-card video').forEach(v => { v.pause(); v.currentTime = 0; });
        }

        function showView(type) {
            const isAll = (type === 'all');
            document.body.className = isAll ? 'dark-mode' : 'light-mode';
            document.querySelectorAll('.tab-item').forEach((el, i) => el.classList.toggle('active', (isAll && i===0) || (!isAll && i===1)));
            document.getElementById('feed-view').style.display = isAll ? 'block' : 'none';
            document.getElementById('grid-view').style.display = isAll ? 'none' : 'grid';
        }

        function setupObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const v = entry.target;
                    if (entry.isIntersecting) { if(!v.src) v.src = v.dataset.src; v.play().catch(() => {}); } 
                    else { v.pause(); v.currentTime = 0; }
                });
            }, { root: document.getElementById('shortsWrapper'), threshold: 0.7 });
            document.querySelectorAll('.short-card video').forEach(v => observer.observe(v));
        }

        window.onload = () => {
            init();
            setTimeout(() => { document.getElementById('splash-screen').classList.add('hide'); }, 1000);
        };
    </script>
</body>
</html>
